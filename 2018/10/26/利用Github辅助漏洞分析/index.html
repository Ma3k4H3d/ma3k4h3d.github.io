<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Cyber Security Penetration Test Fuzzing Hacker IT"><title>利用Github辅助漏洞分析 | Mr.Ma3k4H3d</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">利用Github辅助漏洞分析</h1><a id="logo" href="/.">Mr.Ma3k4H3d</a><p class="description">想要把自己活成一场梦，一首歌，一部电影~</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/history/"><i class="fa fa-user"> 历史</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">利用Github辅助漏洞分析</h1><div class="post-meta">Oct 26, 2018<span> | </span><span class="category"><a href="/categories/Collect/">Collect</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.7k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 6</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#必备工具"><span class="toc-number">1.</span> <span class="toc-text">必备工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#从Github-开始"><span class="toc-number">2.</span> <span class="toc-text">从Github 开始</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Github-commits"><span class="toc-number">3.</span> <span class="toc-text">Github commits</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Github-Search"><span class="toc-number">4.</span> <span class="toc-text">Github Search</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Github-Issus"><span class="toc-number">5.</span> <span class="toc-text">Github Issus</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#在Github-上读代码"><span class="toc-number">6.</span> <span class="toc-text">在Github 上读代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#根据文件夹来阅读"><span class="toc-number">6.1.</span> <span class="toc-text">根据文件夹来阅读</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#根据敏感函数来阅读"><span class="toc-number">6.2.</span> <span class="toc-text">根据敏感函数来阅读</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Git-Clone"><span class="toc-number">7.</span> <span class="toc-text">Git Clone</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Example"><span class="toc-number">8.</span> <span class="toc-text">Example</span></a></li></ol></div></div><div class="post-content"><p>来自于lcatro师傅的分享，原文地址如下：<br><a href="https://github.com/lcatro/How-to-Read-Source-and-Fuzzing/blob/master/1.Github.md" target="_blank" rel="noopener">https://github.com/lcatro/How-to-Read-Source-and-Fuzzing/blob/master/1.Github.md</a></p>
<h2 id="必备工具"><a href="#必备工具" class="headerlink" title="必备工具"></a>必备工具</h2><p>  Git ,Github </p>
<h2 id="从Github-开始"><a href="#从Github-开始" class="headerlink" title="从Github 开始"></a>从Github 开始</h2><p>  Github 是代码分享平台,使用Github 能够找到很多开源项目,关于Github 不多做介绍了,下面分享些使用Github 读代码的操作</p>
<h2 id="Github-commits"><a href="#Github-commits" class="headerlink" title="Github commits"></a>Github commits</h2><p>  Github commits 的功能是用来记录每一次Git 提交代码的信息,里面包含了修改代码的原因,还有修改了哪些代码.Github commits 的功能在这里</p>
<p> <img src="/2018/10/26/利用Github辅助漏洞分析/github_commit.png" alt="github_commit">  </p>
<p>  点击之后,可以看到很多Git 提交代码的记录</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_commit_info.png" alt="github_commit_info"></p>
<p>  随意点开一条记录,可以看到很多关于这条Commit 的信息</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_commit_record.png" alt="github_commit_record"></p>
<p>  使用Github commits 有一个操作就是:<strong>一般来说,部分安全告警或者存在特别严重漏洞的开源项目向外发出通知的时候,往往只是提醒漏洞是影响了哪些版本,什么时候修复,要更新到最新的版本.关于漏洞的详情是很少提及的,甚至PoC 也没有.那么这个时候要怎么去研究漏洞呢?答案是追踪Commit 提交记录</strong></p>
<p>  以CVE-2018-1305 为例子,关于绿盟的对外的通告如下(其他通告都大同小异):</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/nsfocus_record.png" alt="nsfocus_record"></p>
<p>  里面只有一个邮件通信记录,我们进去看看有什么(<a href="https://lists.apache.org/thread.html/d3354bb0a4eda4acc0a66f3eb24a213fdb75d12c7d16060b23e65781@%3Cannounce.tomcat.apache.org%3E" target="_blank" rel="noopener">https://lists.apache.org/thread.html/d3354bb0a4eda4acc0a66f3eb24a213fdb75d12c7d16060b23e65781@%3Cannounce.tomcat.apache.org%3E</a>)</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_email.png" alt="CVE-2018-1305_emai"></p>
<p>  邮件最下面有个References ,翻译为中文是引用的意思,在这里多插一句话:文章里面的引用一般是拓展阅读或者理论/数据的来源依据,如果读者需要进一步去深入这个文章,引用来源就是最好的入手点**.我们挑其中一个引用的URL 来看看(<a href="http://tomcat.apache.org/security-9.html),下面是我挑出的重点信息" target="_blank" rel="noopener">http://tomcat.apache.org/security-9.html),下面是我挑出的重点信息</a></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_info.png" alt="CVE-2018-1305_info"></p>
<p>  圆圈里的意思是漏洞的描述,方框里标明的是其他有用的信息:影响的版本(Affects: 9.0.0.M1 to 9.0.4),最新修复的版本号(Fixed in Apache Tomcat 9.0.5),公开漏洞的时间(11 February 2018),Commit ID (This was fixed in revisions 1823310 and 1824323.).</p>
<p>  找到Commit ID ,点进去看看,这个时候就跳转到了Apache 的SVN Commit 记录里边了(<a href="http://svn.apache.org/viewvc?view=revision&amp;revision=1823310).[PS:SVN" target="_blank" rel="noopener">http://svn.apache.org/viewvc?view=revision&amp;revision=1823310).[PS:SVN</a> 和Git 都是版本管理工具]</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_svn_commit.png" alt="CVE-2018-1305_svn_commit"></p>
<p>  我们可以看到这次修复漏洞修改了哪些代码.但是点进去代码里看,也没有diff ,所以现在回到Git commits 里继续找修复代码的Commit .那么要怎么去找Commit 呢?这个时候,漏洞修复时间就派上用场了.</p>
<p>  SVN 的Commit 里面有一个Commit 时间(如果没有找到对应的Commit ,就在漏洞报告时间(2018/2/1)到漏洞公开时间(2018/2/23)搜索Commit )</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_fix_time.png" alt="CVE-2018-1305_fix_time"></p>
<p>  然后去找Commit ,发现没有找到</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_master_commit.png" alt="CVE-2018-1305_master_commit"></p>
<p>  这就很迷了,为啥会找不到呢.读者们回到主页,点击这里</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_version.png" alt="github_version"></p>
<p>  这个时候,漏洞影响版本号就派上用场了,嘿嘿嘿</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_version_select.png" alt="github_version_select"></p>
<p>  …这里找了个遍都没有找到这个版本,太神奇了,咱们再细细看看漏洞信息哈</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/tips_tomcat.png" alt="tips_tomcat"></p>
<p>  ??? 难道tomcat 和apache 是不同的?那我去搜索一下tomcat [PS:Github 搜索有很多很有趣的使用套路,待会和大家分享一个学习漏洞原理的骚操作]</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search.png" alt="github_search"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_tomcat.png" alt="github_tomcat"></p>
<p>  看来找错了开源项目,那就先看看版本分支吧</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/tomcat_trunk.png" alt="tomcat_trunk"></p>
<p>  有些开源项目是有设置不同的版本分支管理的,没有也没关系,那就来找Commit 吧</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_git_commit.png" alt="CVE-2018-1305_git_commit"></p>
<p>  现在已经定位到了2018/2/6 号的Commit 信息,这里有几个Commit ,一个一个慢慢看吧,搜素的过程就不多说了,最后定位到这两个Commit</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_git_commit_1.png" alt="CVE-2018-1305_git_commit_1"></p>
<p>  修复代码:<a href="https://github.com/apache/tomcat/commit/3e54b2a6314eda11617ff7a7b899c251e222b1a1" target="_blank" rel="noopener">https://github.com/apache/tomcat/commit/3e54b2a6314eda11617ff7a7b899c251e222b1a1</a><br>  测试用例:<a href="https://github.com/apache/tomcat/commit/af0c19ffdbe525ad690da4fd7e988c7788d00141" target="_blank" rel="noopener">https://github.com/apache/tomcat/commit/af0c19ffdbe525ad690da4fd7e988c7788d00141</a></p>
<p>  在Git 的Commit 里还能看到Diff ,很容易就知道到底哪些代码被修改过(包括代码注释)</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_git_diff.png" alt="CVE-2018-1305_git_diff"></p>
<p>  在测试用例里面就可以直接找到PoC 了</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/CVE-2018-1305_test_case.png" alt="CVE-2018-1305_test_case"></p>
<h2 id="Github-Search"><a href="#Github-Search" class="headerlink" title="Github Search"></a>Github Search</h2><p>  前面已经说到了如何使用Commit 了,相信读者也已经去秀了一波操作,找到更多关于漏洞修复的细节,上一节有提到,关于Github Search 有一个学习代码的骚操作,当年我就是用这一招弄明白了JavaScript 这种脚本解析引擎的漏洞应该要怎么挖,是不是很想知道到底是啥套路.</p>
<p>  在搜索框里输入<code>CVE</code> ,记住,要想挖哪个开源项目就去那个开源项目的Github 上搜素CVE 三个字</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search_cve.png" alt="github_search_cve"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search_cve_result.png" alt="github_search_cve_result"></p>
<p>  结果如上,这个是Code 搜素,搜素出来的结果比较少,咱们切换到Commits 来看看</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search_cve_commit_result.png" alt="github_search_cve_commit_result"></p>
<p>  是不是发现了新世界 :)</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search_1.png" alt="github_search_1"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search_2.png" alt="github_search_2"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search_3.png" alt="github_search_3"></p>
<p>  洞海无涯苦作舟,用这种方法可以从issus 和Commit 里面学到很多,但是要看懂整个Commit 不只是要看Diff ,还要下载代码到本地一步一步分析漏洞成因</p>
<h2 id="Github-Issus"><a href="#Github-Issus" class="headerlink" title="Github Issus"></a>Github Issus</h2><p>  Issus 可以看到很多漏洞挖掘的操作,特别是AFL 和libFuzzer 的怎么样使用的,同时在这些提交漏洞的Issus 里还能收集到很多样本,可以直接拿下来到其他的开源项目里继续使用,举个例子,ImageMagick 的Issus :<a href="https://github.com/ImageMagick/ImageMagick/issues" target="_blank" rel="noopener">https://github.com/ImageMagick/ImageMagick/issues</a></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_issus.png" alt="github_issus"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_issus_info.png" alt="github_issus_info"></p>
<p>  这里告诉大家样本在哪儿可以下载,重点是触发的命令是什么,有了这个触发命令之后,我们也可以去照猫画虎拿到AFL 里去跑Fuzzing 啦,美滋滋</p>
<h2 id="在Github-上读代码"><a href="#在Github-上读代码" class="headerlink" title="在Github 上读代码"></a>在Github 上读代码</h2><p>  一般我都是先在Github 上阅读代码,然后再下载代码到本地Source Insight 继续读.我们有两种方式在Github 上开始阅读</p>
<h3 id="根据文件夹来阅读"><a href="#根据文件夹来阅读" class="headerlink" title="根据文件夹来阅读"></a>根据文件夹来阅读</h3><p>  简单地来说:<strong>关注文件/文件夹的名字</strong></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/dir_php.png" alt="dir_php"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/dir_antminer.png" alt="dir_antmine"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/file_redis.png" alt="file_redis"></p>
<p>  多翻一下目录和文件,总会遇到你感兴趣的一个地方来读</p>
<h3 id="根据敏感函数来阅读"><a href="#根据敏感函数来阅读" class="headerlink" title="根据敏感函数来阅读"></a>根据敏感函数来阅读</h3><p>  善用Github 的搜索功能,它能够帮你搜索代码或者其他信息</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search_function.png" alt="github_search_function"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/github_search_function1.png" alt="github_search_function1"></p>
<p>  找到了一个感兴趣的地方开始阅读代码之后,Github 的搜素功能可以帮助你向上回溯代码</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/save_command.png" alt="save_command"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/save_command_find.png" alt="save_command_find"></p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/save_command_find_in_browser.png" alt="save_command_find_in_browse"></p>
<p>  在网页和普通编辑器阅读源码记得要多使用<code>Ctrl + F</code> ,它能够帮你快速定位当前代码文件的函数定位</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/ctrl_f_find.png" alt="ctrl_f_find"></p>
<h2 id="Git-Clone"><a href="#Git-Clone" class="headerlink" title="Git Clone"></a>Git Clone</h2><p>  这个就不多介绍了,下载代码到本地</p>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>  去年挖到一个蚂蚁矿机的远程代码执行漏洞,发现这个问题是直接在Github 上读代码的找到的,附上源码分析.</p>
<p><img src="/2018/10/26/利用Github辅助漏洞分析/source.png" alt="source"></p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2018/10/27/Fuzzing技术总结与工具列表/">Fuzzing技术总结与工具列表</a><a class="next" href="/2018/10/21/Hexo-Maupassant-博客搭建/">Hexo &amp; Maupassant 博客搭建</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ATO-ThreatIntelligence/">ATO-ThreatIntelligence</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CVE-Search/">CVE_Search</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Collect/">Collect</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/原创/">原创</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/腾讯玄武实验室安全动态推送/">腾讯玄武实验室安全动态推送</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/OSINT/" style="font-size: 15px;">OSINT</a> <a href="/tags/Vim/" style="font-size: 15px;">Vim</a> <a href="/tags/SecNews/" style="font-size: 15px;">SecNews</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/CVE/" style="font-size: 15px;">CVE</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/10/27/Fuzzing技术总结与工具列表/">Fuzzing技术总结与工具列表</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/26/利用Github辅助漏洞分析/">利用Github辅助漏洞分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/21/Hexo-Maupassant-博客搭建/">Hexo & Maupassant 博客搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/21/ATO-Test/">ATO_Test</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/21/xuanwu-2018-10-21/">腾讯玄武实验室安全动态推送</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/10/21/CVE-2017-0358/">CVE-2017-0358</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/03/JS-study/">JS学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/02/SSH-Git/">SSH & Git</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/01/Vim折腾记/">Vim折腾记</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/26/hexo-多PC同步及备份/">Hexo 多PC同步及备份</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.t00ls.net/" title="T00ls" target="_blank">T00ls</a><ul></ul><a href="https://maskhed.github.io/" title="Ma3k4H3d" target="_blank">Ma3k4H3d</a><ul></ul><a href="https://musicforprogramming.net" title="musicforprogramming.net" target="_blank">musicforprogramming.net</a><ul></ul><a href="https://github.com/maskhed/MyPapers" title="Papers" target="_blank">Papers</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Mr.Ma3k4H3d.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="208,55,66" opacity="0.3" zIndex="-1" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>